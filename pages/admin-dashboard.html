<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - GO India RIDE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f2f5;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            overflow-y: auto;
            z-index: 100;
        }

        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-logo {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sidebar-menu {
            padding: 1.5rem 0;
        }

        .menu-item {
            padding: 1rem 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.1);
            border-left-color: white;
        }

        .menu-item.active {
            background: rgba(255,255,255,0.15);
            border-left-color: white;
        }

        .menu-item i {
            font-size: 1.2rem;
            width: 30px;
        }

        /* Top Bar */
        .topbar {
            position: fixed;
            top: 0;
            left: 250px;
            right: 0;
            height: 70px;
            background: white;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
            z-index: 99;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .topbar-title {
            font-size: 1.5rem;
            color: #333;
            font-weight: bold;
        }

        .topbar-right {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .admin-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .admin-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .logout-btn {
            background: none;
            border: none;
            color: #667eea;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            color: #764ba2;
        }

        /* Main Content */
        .main-content {
            margin-left: 250px;
            margin-top: 70px;
            padding: 2rem;
        }

        /* Dashboard Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 4px solid #667eea;
        }

        .stat-card.danger {
            border-left-color: #f44336;
        }

        .stat-card.success {
            border-left-color: #4caf50;
        }

        .stat-card.warning {
            border-left-color: #ff9800;
        }

        .stat-label {
            color: #999;
            font-size: 0.9rem;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .stat-change {
            font-size: 0.85rem;
            color: #999;
        }

        /* Tabs */
        .tab-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .tab-buttons {
            display: flex;
            border-bottom: 2px solid #eee;
            overflow-x: auto;
        }

        .tab-button {
            flex: 1;
            padding: 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #999;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            min-width: 150px;
        }

        .tab-button:hover {
            color: #667eea;
            background: #f9f9f9;
        }

        .tab-button.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
            padding: 2rem;
        }

        .tab-content.active {
            display: block;
        }

        /* Tables */
        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #f5f5f5;
            border-bottom: 2px solid #eee;
        }

        th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid #eee;
            color: #666;
        }

        tr:hover {
            background: #f9f9f9;
        }

        .status-badge {
            display: inline-block;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-pending {
            background: #fff3e0;
            color: #ff9800;
        }

        .status-confirmed {
            background: #e3f2fd;
            color: #2196f3;
        }

        .status-completed {
            background: #e8f5e9;
            color: #4caf50;
        }

        .status-cancelled {
            background: #ffebee;
            color: #f44336;
        }

        .action-btns {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            padding: 0.5rem 0.8rem;
            border: 1px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
        }

        .action-btn:hover {
            background: #667eea;
            color: white;
        }

        .action-btn.danger {
            border-color: #f44336;
            color: #f44336;
        }

        .action-btn.danger:hover {
            background: #f44336;
            color: white;
        }

        /* Forms */
        .form-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.9rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: inherit;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-secondary:hover {
            background: #f0f4ff;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #eee;
        }

        .modal-header h2 {
            margin: 0;
            color: #333;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
        }

        /* Messages */
        .message {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }

        .message.show {
            display: block;
        }

        .message.success {
            background: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid #4caf50;
        }

        .message.error {
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #f44336;
        }

        .message.warning {
            background: #fff3e0;
            color: #e65100;
            border-left: 4px solid #ff9800;
        }

        /* Charts */
        .chart-container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
        }

        .chart-title {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 1.5rem;
            font-weight: bold;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #999;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state p {
            margin: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }

            .topbar {
                left: 200px;
                padding: 0 1rem;
            }

            .main-content {
                margin-left: 200px;
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .tab-buttons {
                overflow-x: auto;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: 0.7rem;
            }
        }

        @media (max-width: 600px) {
            .sidebar {
                display: none;
            }

            .topbar {
                left: 0;
            }

            .main-content {
                margin-left: 0;
            }
        }

        .scroll-x {
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <i class="fas fa-taxi"></i>
                GO India RIDE
            </div>
        </div>
        <div class="sidebar-menu">
            <div class="menu-item active" onclick="switchTab('dashboard')">
                <i class="fas fa-chart-line"></i>
                <span>Dashboard</span>
            </div>
            <div class="menu-item" onclick="switchTab('bookings')">
                <i class="fas fa-calendar-check"></i>
                <span>Bookings</span>
            </div>
            <div class="menu-item" onclick="switchTab('customers')">
                <i class="fas fa-users"></i>
                <span>Customers</span>
            </div>
            <div class="menu-item" onclick="switchTab('drivers')">
                <i class="fas fa-car"></i>
                <span>Drivers</span>
            </div>
            <div class="menu-item" onclick="switchTab('earnings')">
                <i class="fas fa-money-bill"></i>
                <span>Earnings</span>
            </div>
            <div class="menu-item" onclick="switchTab('reports')">
                <i class="fas fa-file-chart-line"></i>
                <span>Reports</span>
            </div>
            <div class="menu-item" onclick="switchTab('settings')">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
        </div>
    </div>

    <!-- Topbar -->
    <div class="topbar">
        <div class="topbar-title" id="topbarTitle">Dashboard</div>
        <div class="topbar-right">
            <div class="admin-profile">
                <div class="admin-avatar">A</div>
                <span id="adminName">Admin User</span>
            </div>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                Logout
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Messages -->
        <div class="message success" id="successMessage">
            <i class="fas fa-check-circle"></i>
            <span id="successText"></span>
        </div>
        <div class="message error" id="errorMessage">
            <i class="fas fa-exclamation-circle"></i>
            <span id="errorText"></span>
        </div>

        <!-- Dashboard Tab -->
        <div class="tab-content active" id="dashboardTab">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Bookings</div>
                    <div class="stat-value" id="totalBookings">0</div>
                    <div class="stat-change">All time bookings</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-label">Completed Rides</div>
                    <div class="stat-value" id="completedRides">0</div>
                    <div class="stat-change" id="completedToday">0 today</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-label">Pending Bookings</div>
                    <div class="stat-value" id="pendingBookings">0</div>
                    <div class="stat-change">Awaiting confirmation</div>
                </div>
                <div class="stat-card danger">
                    <div class="stat-label">Cancelled Rides</div>
                    <div class="stat-value" id="cancelledRides">0</div>
                    <div class="stat-change" id="cancelledToday">0 today</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Revenue</div>
                    <div class="stat-value" id="totalRevenue">₹0</div>
                    <div class="stat-change" id="revenueToday">₹0 today</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active Drivers</div>
                    <div class="stat-value" id="activeDrivers">0</div>
                    <div class="stat-change" id="totalDrivers">0 total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Customers</div>
                    <div class="stat-value" id="totalCustomers">0</div>
                    <div class="stat-change">Registered users</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Avg Rating</div>
                    <div class="stat-value" id="avgRating">5.0 ⭐</div>
                    <div class="stat-change">Based on reviews</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">Recent Bookings Overview</div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>Booking ID</th>
                                <th>Customer</th>
                                <th>Route</th>
                                <th>Ride Type</th>
                                <th>Fare</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="recentBookingsTable">
                            <tr>
                                <td colspan="8" class="empty-state">
                                    <i class="fas fa-inbox"></i>
                                    <p>No bookings yet</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Bookings Tab -->
        <div class="tab-content" id="bookingsTab">
            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-button active" onclick="switchBookingFilter('all')">All</button>
                    <button class="tab-button" onclick="switchBookingFilter('pending')">Pending</button>
                    <button class="tab-button" onclick="switchBookingFilter('confirmed')">Confirmed</button>
                    <button class="tab-button" onclick="switchBookingFilter('completed')">Completed</button>
                    <button class="tab-button" onclick="switchBookingFilter('cancelled')">Cancelled</button>
                </div>
                <div style="padding: 2rem;">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Customer</th>
                                    <th>Pickup</th>
                                    <th>Dropoff</th>
                                    <th>Driver</th>
                                    <th>Fare</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="bookingsTableBody">
                                <tr>
                                    <td colspan="8" class="empty-state">
                                        <i class="fas fa-inbox"></i>
                                        <p>No bookings found</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Customers Tab -->
        <div class="tab-content" id="customersTab">
            <div style="margin-bottom: 2rem;">
                <button class="btn btn-primary" onclick="openAddCustomerModal()">
                    <i class="fas fa-user-plus"></i>
                    Add Customer
                </button>
            </div>
            <div class="tab-container">
                <div style="padding: 2rem;">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Rides</th>
                                    <th>Total Spent</th>
                                    <th>Rating</th>
                                    <th>Joined</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="customersTableBody">
                                <tr>
                                    <td colspan="8" class="empty-state">
                                        <i class="fas fa-inbox"></i>
                                        <p>No customers yet</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Drivers Tab -->
        <div class="tab-content" id="driversTab">
            <div style="margin-bottom: 2rem;">
                <button class="btn btn-primary" onclick="openAddDriverModal()">
                    <i class="fas fa-car-plus"></i>
                    Add Driver
                </button>
            </div>
            <div class="tab-container">
                <div style="padding: 2rem;">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Vehicle</th>
                                    <th>Rides</th>
                                    <th>Earnings</th>
                                    <th>Rating</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="driversTableBody">
                                <tr>
                                    <td colspan="9" class="empty-state">
                                        <i class="fas fa-inbox"></i>
                                        <p>No drivers yet</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Earnings Tab -->
        <div class="tab-content" id="earningsTab">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Today's Revenue</div>
                    <div class="stat-value" id="todayRevenue">₹0</div>
                    <div class="stat-change" id="todayRides">0 rides</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">This Week</div>
                    <div class="stat-value" id="weekRevenue">₹0</div>
                    <div class="stat-change" id="weekRides">0 rides</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">This Month</div>
                    <div class="stat-value" id="monthRevenue">₹0</div>
                    <div class="stat-change" id="monthRides">0 rides</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-label">Driver Earnings</div>
                    <div class="stat-value" id="driverEarnings">₹0</div>
                    <div class="stat-change">Distributed</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">Revenue Details</div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Rides</th>
                                <th>Total Fare</th>
                                <th>Driver Share (70%)</th>
                                <th>Platform (30%)</th>
                            </tr>
                        </thead>
                        <tbody id="earningsTableBody">
                            <tr>
                                <td colspan="5" class="empty-state">
                                    <i class="fas fa-chart-line"></i>
                                    <p>No earnings data</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div class="tab-content" id="reportsTab">
            <div class="form-section">
                <h3 style="margin-bottom: 1.5rem;">Generate Reports</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="reportType">Report Type</label>
                        <select id="reportType">
                            <option value="revenue">Revenue Report</option>
                            <option value="rides">Rides Report</option>
                            <option value="drivers">Drivers Report</option>
                            <option value="customers">Customers Report</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="reportDateFrom">From Date</label>
                        <input type="date" id="reportDateFrom">
                    </div>
                    <div class="form-group">
                        <label for="reportDateTo">To Date</label>
                        <input type="date" id="reportDateTo">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="generateReport()">
                    <i class="fas fa-file-pdf"></i>
                    Generate Report
                </button>
            </div>

            <div class="chart-container">
                <div class="chart-title">System Statistics</div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Value</th>
                                <th>Change</th>
                            </tr>
                        </thead>
                        <tbody id="reportTableBody">
                            <tr>
                                <td colspan="3" class="empty-state">
                                    <i class="fas fa-chart-bar"></i>
                                    <p>No report data</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settingsTab">
            <div class="form-section">
                <h3 style="margin-bottom: 1.5rem;">Application Settings</h3>
                
                <div class="form-group">
                    <label for="baseFare">Base Fare (₹)</label>
                    <input type="number" id="baseFare" value="50" min="0">
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="economyRate">Economy Rate (₹/km)</label>
                        <input type="number" id="economyRate" value="10" min="0">
                    </div>
                    <div class="form-group">
                        <label for="premiumRate">Premium Rate (₹/km)</label>
                        <input type="number" id="premiumRate" value="15" min="0">
                    </div>
                    <div class="form-group">
                        <label for="xlRate">XL Rate (₹/km)</label>
                        <input type="number" id="xlRate" value="20" min="0">
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="driverShare">Driver Share (%)</label>
                        <input type="number" id="driverShare" value="70" min="0" max="100">
                    </div>
                    <div class="form-group">
                        <label for="platformShare">Platform Share (%)</label>
                        <input type="number" id="platformShare" value="30" min="0" max="100">
                    </div>
                    <div class="form-group">
                        <label for="tax">Tax (%)</label>
                        <input type="number" id="tax" value="10" min="0" max="100">
                    </div>
                </div>

                <h3 style="margin-top: 2rem; margin-bottom: 1.5rem;">Notifications</h3>
                <div style="display: flex; gap: 2rem;">
                    <label>
                        <input type="checkbox" id="emailNotif" checked>
                        <span>Email Notifications</span>
                    </label>
                    <label>
                        <input type="checkbox" id="smsNotif" checked>
                        <span>SMS Notifications</span>
                    </label>
                    <label>
                        <input type="checkbox" id="pushNotif" checked>
                        <span>Push Notifications</span>
                    </label>
                </div>

                <div style="margin-top: 2rem;">
                    <button class="btn btn-primary" onclick="saveSettings()">
                        <i class="fas fa-save"></i>
                        Save Settings
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Customer Modal -->
    <div class="modal" id="addCustomerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Customer</h2>
                <button class="modal-close" onclick="closeAddCustomerModal()">&times;</button>
            </div>
            <form onsubmit="saveCustomer(event)">
                <div class="form-group">
                    <label for="custName">Full Name</label>
                    <input type="text" id="custName" required>
                </div>
                <div class="form-group">
                    <label for="custEmail">Email</label>
                    <input type="email" id="custEmail" required>
                </div>
                <div class="form-group">
                    <label for="custPhone">Phone</label>
                    <input type="tel" id="custPhone" required>
                </div>
                <div class="form-group">
                    <label for="custPassword">Password</label>
                    <input type="password" id="custPassword" required>
                </div>
                <button type="submit" class="btn btn-primary">Add Customer</button>
            </form>
        </div>
    </div>

    <!-- Add Driver Modal -->
    <div class="modal" id="addDriverModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Driver</h2>
                <button class="modal-close" onclick="closeAddDriverModal()">&times;</button>
            </div>
            <form onsubmit="saveDriver(event)">
                <div class="form-group">
                    <label for="drvName">Full Name</label>
                    <input type="text" id="drvName" required>
                </div>
                <div class="form-group">
                    <label for="drvEmail">Email</label>
                    <input type="email" id="drvEmail" required>
                </div>
                <div class="form-group">
                    <label for="drvPhone">Phone</label>
                    <input type="tel" id="drvPhone" required>
                </div>
                <div class="form-group">
                    <label for="drvPassword">Password</label>
                    <input type="password" id="drvPassword" required>
                </div>
                <div class="form-group">
                    <label for="drvVehicle">Vehicle Type</label>
                    <select id="drvVehicle" required>
                        <option value="economy">Economy</option>
                        <option value="premium">Premium</option>
                        <option value="xl">XL</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="drvVehicleNumber">Vehicle Number</label>
                    <input type="text" id="drvVehicleNumber" placeholder="RJ 01 AB 1234" required>
                </div>
                <button type="submit" class="btn btn-primary">Add Driver</button>
            </form>
        </div>
    </div>

    <script>
        // ============================================
        // AUTHENTICATION CHECK
        // ============================================

        function checkAuth() {
            const userRole = localStorage.getItem('userRole');
            const currentAdmin = localStorage.getItem('currentAdmin');

            if (userRole !== 'admin' || !currentAdmin) {
                alert('Please login as admin first');
                window.location.href = './login.html';
                return null;
            }

            return JSON.parse(currentAdmin);
        }

        let currentAdmin = null;
        let bookingFilter = 'all';

        window.addEventListener('load', function() {
            currentAdmin = checkAuth();
            if (!currentAdmin) return;

            document.getElementById('adminName').textContent = currentAdmin.name;
            loadDashboard();
            loadAllData();
        });

        // ============================================
        // LOAD DASHBOARD DATA
        // ============================================

        function loadDashboard() {
            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
            const customers = JSON.parse(localStorage.getItem('users')) || [];
            const drivers = JSON.parse(localStorage.getItem('drivers')) || [];

            const totalBookings = bookings.length;
            const completedRides = bookings.filter(b => b.status === 'completed').length;
            const pendingBookings = bookings.filter(b => b.status === 'pending').length;
            const cancelledRides = bookings.filter(b => b.status === 'cancelled').length;

            const today = new Date().toDateString();
            const completedToday = bookings.filter(b => 
                b.status === 'completed' && 
                new Date(b.createdAt).toDateString() === today
            ).length;
            const cancelledToday = bookings.filter(b => 
                b.status === 'cancelled' && 
                new Date(b.createdAt).toDateString() === today
            ).length;

            const totalRevenue = bookings
                .filter(b => b.status === 'completed')
                .reduce((sum, b) => sum + (b.totalFare || 0), 0);

            const revenueToday = bookings
                .filter(b => b.status === 'completed' && new Date(b.createdAt).toDateString() === today)
                .reduce((sum, b) => sum + (b.totalFare || 0), 0);

            const activeDrivers = drivers.filter(d => d.isOnline).length;
            const totalCustomers = customers.length;

            // Update stats
            document.getElementById('totalBookings').textContent = totalBookings;
            document.getElementById('completedRides').textContent = completedRides;
            document.getElementById('completedToday').textContent = `${completedToday} today`;
            document.getElementById('pendingBookings').textContent = pendingBookings;
            document.getElementById('cancelledRides').textContent = cancelledRides;
            document.getElementById('cancelledToday').textContent = `${cancelledToday} today`;
            document.getElementById('totalRevenue').textContent = `₹${totalRevenue}`;
            document.getElementById('revenueToday').textContent = `₹${revenueToday} today`;
            document.getElementById('activeDrivers').textContent = activeDrivers;
            document.getElementById('totalDrivers').textContent = `${drivers.length} total`;
            document.getElementById('totalCustomers').textContent = totalCustomers;

            // Recent bookings
            const recentBookings = bookings.slice(-5).reverse();
            const recentTable = document.getElementById('recentBookingsTable');
            if (recentBookings.length === 0) {
                recentTable.innerHTML = '<tr><td colspan="8" class="empty-state"><i class="fas fa-inbox"></i><p>No bookings yet</p></td></tr>';
            } else {
                recentTable.innerHTML = recentBookings.map(b => `
                    <tr>
                        <td><strong>${b.id}</strong></td>
                        <td>${b.customerName}</td>
                        <td><small>${b.pickup}</small></td>
                        <td><small>${b.dropoff}</small></td>
                        <td>${b.rideType}</td>
                        <td><strong>₹${b.totalFare}</strong></td>
                        <td><span class="status-badge status-${b.status}">${b.status.toUpperCase()}</span></td>
                        <td>
                            <div class="action-btns">
                                <button class="action-btn" onclick="viewBooking('${b.id}')">View</button>
                            </div>
                        </td>
                    </tr>
                `).join('');
            }
        }

        function loadAllData() {
            loadBookings();
            loadCustomers();
            loadDrivers();
            loadEarnings();
        }

        // ============================================
        // LOAD BOOKINGS
        // ============================================

        function loadBookings() {
            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
            let filtered = bookings;

            if (bookingFilter !== 'all') {
                filtered = bookings.filter(b => b.status === bookingFilter);
            }

            const table = document.getElementById('bookingsTableBody');
            if (filtered.length === 0) {
                table.innerHTML = '<tr><td colspan="8" class="empty-state"><i class="fas fa-inbox"></i><p>No bookings found</p></td></tr>';
            } else {
                table.innerHTML = filtered.map(b => `
                    <tr>
                        <td>${b.id}</td>
                        <td>${b.customerName}</td>
                        <td>${b.pickup}</td>
                        <td>${b.dropoff}</td>
                        <td>${b.driverName || 'Unassigned'}</td>
                        <td>₹${b.totalFare}</td>
                        <td><span class="status-badge status-${b.status}">${b.status.toUpperCase()}</span></td>
                        <td>
                            <div class="action-btns">
                                <button class="action-btn" onclick="viewBooking('${b.id}')">View</button>
                                ${b.status === 'pending' ? `<button class="action-btn" onclick="confirmBooking('${b.id}')">Confirm</button>` : ''}
                                ${b.status !== 'completed' && b.status !== 'cancelled' ? `<button class="action-btn danger" onclick="cancelBooking('${b.id}')">Cancel</button>` : ''}
                            </div>
                        </td>
                    </tr>
                `).join('');
            }
        }

        function switchBookingFilter(filter) {
            bookingFilter = filter;
            document.querySelectorAll('.tab-buttons .tab-button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            loadBookings();
        }

        function confirmBooking(bookingId) {
            let bookings = JSON.parse(localStorage.getItem('bookings')) || [];
            const idx = bookings.findIndex(b => b.id === bookingId);
            
            if (idx !== -1) {
                bookings[idx].status = 'confirmed';
                // Auto-assign driver
                const drivers = JSON.parse(localStorage.getItem('drivers')) || [];
                if (drivers.length > 0) {
                    const randomDriver = drivers[Math.floor(Math.random() * drivers.length)];
                    bookings[idx].driverId = randomDriver.id;
                    bookings[idx].driverName = randomDriver.name;
                }
                localStorage.setItem('bookings', JSON.stringify(bookings));
                showSuccess('✅ Booking confirmed & driver assigned!');
                loadDashboard();
                loadBookings();
            }
        }

        function cancelBooking(bookingId) {
            if (confirm('Are you sure you want to cancel this booking?')) {
                let bookings = JSON.parse(localStorage.getItem('bookings')) || [];
                const idx = bookings.findIndex(b => b.id === bookingId);
                if (idx !== -1) {
                    bookings[idx].status = 'cancelled';
                    localStorage.setItem('bookings', JSON.stringify(bookings));
                    showSuccess('❌ Booking cancelled');
                    loadDashboard();
                    loadBookings();
                }
            }
        }

        function viewBooking(bookingId) {
            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
            const booking = bookings.find(b => b.id === bookingId);
            if (booking) {
                alert(`
Booking Details:
ID: ${booking.id}
Customer: ${booking.customerName}
Phone: ${booking.customerPhone}
Pickup: ${booking.pickup}
Dropoff: ${booking.dropoff}
Ride Type: ${booking.rideType}
Fare: ₹${booking.totalFare}
Status: ${booking.status}
Date: ${new Date(booking.createdAt).toLocaleString()}
${booking.driverName ? `Driver: ${booking.driverName}` : ''}
${booking.notes ? `Notes: ${booking.notes}` : ''}
                `);
            }
        }

        // ============================================
        // LOAD CUSTOMERS
        // ============================================

        function loadCustomers() {
            const customers = JSON.parse(localStorage.getItem('users')) || [];
            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];

            const table = document.getElementById('customersTableBody');
            if (customers.length === 0) {
                table.innerHTML = '<tr><td colspan="8" class="empty-state"><i class="fas fa-inbox"></i><p>No customers yet</p></td></tr>';
            } else {
                table.innerHTML = customers.map(c => {
                    const custBookings = bookings.filter(b => b.customerId === c.id);
                    const totalSpent = custBookings
                        .filter(b => b.status === 'completed')
                        .reduce((sum, b) => sum + (b.totalFare || 0), 0);
                    const joinDate = new Date(c.createdAt).toLocaleDateString();

                    return `
                        <tr>
                            <td>${c.fullname}</td>
                            <td>${c.email}</td>
                            <td>${c.phone}</td>
                            <td>${custBookings.length}</td>
                            <td>₹${totalSpent}</td>
                            <td>5.0 ⭐</td>
                            <td>${joinDate}</td>
                            <td>
                                <div class="action-btns">
                                    <button class="action-btn" onclick="viewCustomer('${c.id}')">View</button>
                                    <button class="action-btn danger" onclick="deleteCustomer('${c.id}')">Delete</button>
                                </div>
                            </td>
                        </tr>
                    `;
                }).join('');
            }
        }

        function openAddCustomerModal() {
            document.getElementById('addCustomerModal').classList.add('active');
        }

        function closeAddCustomerModal() {
            document.getElementById('addCustomerModal').classList.remove('active');
        }

        function saveCustomer(e) {
            e.preventDefault();

            const customer = {
                id: 'user_' + Date.now(),
                fullname: document.getElementById('custName').value,
                email: document.getElementById('custEmail').value.toLowerCase(),
                phone: document.getElementById('custPhone').value,
                password: document.getElementById('custPassword').value,
                role: 'customer',
                createdAt: new Date().toISOString()
            };

            let users = JSON.parse(localStorage.getItem('users')) || [];
            users.push(customer);
            localStorage.setItem('users', JSON.stringify(users));

            showSuccess('✅ Customer added successfully!');
            closeAddCustomerModal();
            loadCustomers();
            document.querySelector('#addCustomerModal form').reset();
        }

        function viewCustomer(customerId) {
            const customers = JSON.parse(localStorage.getItem('users')) || [];
            const customer = customers.find(c => c.id === customerId);
            if (customer) {
                alert(`
Customer Details:
Name: ${customer.fullname}
Email: ${customer.email}
Phone: ${customer.phone}
Joined: ${new Date(customer.createdAt).toLocaleDateString()}
                `);
            }
        }

        function deleteCustomer(customerId) {
            if (confirm('Are you sure? This will delete the customer account.')) {
                let users = JSON.parse(localStorage.getItem('users')) || [];
                users = users.filter(u => u.id !== customerId);
                localStorage.setItem('users', JSON.stringify(users));
                showSuccess('❌ Customer deleted');
                loadCustomers();
            }
        }

        // ============================================
        // LOAD DRIVERS
        // ============================================

        function loadDrivers() {
            const drivers = JSON.parse(localStorage.getItem('drivers')) || [];
            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];

            const table = document.getElementById('driversTableBody');
            if (drivers.length === 0) {
                table.innerHTML = '<tr><td colspan="9" class="empty-state"><i class="fas fa-inbox"></i><p>No drivers yet</p></td></tr>';
            } else {
                table.innerHTML = drivers.map(d => {
                    const drvBookings = bookings.filter(b => b.driverId === d.id && b.status === 'completed');
                    const earnings = drvBookings.reduce((sum, b) => sum + (b.driverEarnings || 0), 0);
                    const status = d.isOnline ? 'Online' : 'Offline';

                    return `
                        <tr>
                            <td>${d.name}</td>
                            <td>${d.email}</td>
                            <td>${d.phone}</td>
                            <td>${d.vehicleType} - ${d.vehicleNumber}</td>
                            <td>${drvBookings.length}</td>
                            <td>₹${earnings}</td>
                            <td>5.0 ⭐</td>
                            <td><span class="status-badge status-${d.isOnline ? 'confirmed' : 'pending'}">${status}</span></td>
                            <td>
                                <div class="action-btns">
                                    <button class="action-btn" onclick="viewDriver('${d.id}')">View</button>
                                    <button class="action-btn" onclick="toggleDriver('${d.id}')">${d.isOnline ? 'Suspend' : 'Activate'}</button>
                                    <button class="action-btn danger" onclick="deleteDriver('${d.id}')">Delete</button>
                                </div>
                            </td>
                        </tr>
                    `;
                }).join('');
            }
        }

        function openAddDriverModal() {
            document.getElementById('addDriverModal').classList.add('active');
        }

        function closeAddDriverModal() {
            document.getElementById('addDriverModal').classList.remove('active');
        }

        function saveDriver(e) {
            e.preventDefault();

            const driver = {
                id: 'driver_' + Date.now(),
                name: document.getElementById('drvName').value,
                email: document.getElementById('drvEmail').value.toLowerCase(),
                phone: document.getElementById('drvPhone').value,
                password: document.getElementById('drvPassword').value,
                vehicleType: document.getElementById('drvVehicle').value,
                vehicleNumber: document.getElementById('drvVehicleNumber').value,
                role: 'driver',
                isOnline: true,
                createdAt: new Date().toISOString()
            };

            let drivers = JSON.parse(localStorage.getItem('drivers')) || [];
            drivers.push(driver);
            localStorage.setItem('drivers', JSON.stringify(drivers));

            showSuccess('✅ Driver added successfully!');
            closeAddDriverModal();
            loadDrivers();
            document.querySelector('#addDriverModal form').reset();
        }

        function viewDriver(driverId) {
            const drivers = JSON.parse(localStorage.getItem('drivers')) || [];
            const driver = drivers.find(d => d.id === driverId);
            if (driver) {
                alert(`
Driver Details:
Name: ${driver.name}
Email: ${driver.email}
Phone: ${driver.phone}
Vehicle: ${driver.vehicleType}
Registration: ${driver.vehicleNumber}
Status: ${driver.isOnline ? 'Online' : 'Offline'}
Joined: ${new Date(driver.createdAt).toLocaleDateString()}
                `);
            }
        }

        function toggleDriver(driverId) {
            let drivers = JSON.parse(localStorage.getItem('drivers')) || [];
            const idx = drivers.findIndex(d => d.id === driverId);
            if (idx !== -1) {
                drivers[idx].isOnline = !drivers[idx].isOnline;
                localStorage.setItem('drivers', JSON.stringify(drivers));
                const action = drivers[idx].isOnline ? 'Activated' : 'Suspended';
                showSuccess(`✅ Driver ${action}`);
                loadDrivers();
            }
        }

        function deleteDriver(driverId) {
            if (confirm('Are you sure? This will delete the driver account.')) {
                let drivers = JSON.parse(localStorage.getItem('drivers')) || [];
                drivers = drivers.filter(d => d.id !== driverId);
                localStorage.setItem('drivers', JSON.stringify(drivers));
                showSuccess('❌ Driver deleted');
                loadDrivers();
            }
        }

        // ============================================
        // LOAD EARNINGS
        // ============================================

        function loadEarnings() {
            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
            const completedBookings = bookings.filter(b => b.status === 'completed');

            const today = new Date().toDateString();
            const todayBookings = completedBookings.filter(b => 
                new Date(b.createdAt).toDateString() === today
            );

            const todayRevenue = todayBookings.reduce((sum, b) => sum + (b.totalFare || 0), 0);
            const todayRideCount = todayBookings.length;

            // Week
            const weekStart = new Date();
            weekStart.setDate(weekStart.getDate() - weekStart.getDay());
            const weekBookings = completedBookings.filter(b => 
                new Date(b.createdAt) >= weekStart
            );
            const weekRevenue = weekBookings.reduce((sum, b) => sum + (b.totalFare || 0), 0);

            // Month
            const monthStart = new Date();
            monthStart.setDate(1);
            const monthBookings = completedBookings.filter(b => 
                new Date(b.createdAt) >= monthStart
            );
            const monthRevenue = monthBookings.reduce((sum, b) => sum + (b.totalFare || 0), 0);

            const driverShare = (completedBookings.reduce((sum, b) => sum + (b.totalFare || 0), 0) * 0.7);

            document.getElementById('todayRevenue').textContent = `₹${todayRevenue}`;
            document.getElementById('todayRides').textContent = `${todayRideCount} rides`;
            document.getElementById('weekRevenue').textContent = `₹${weekRevenue}`;
            document.getElementById('weekRides').textContent = `${weekBookings.length} rides`;
            document.getElementById('monthRevenue').textContent = `₹${monthRevenue}`;
            document.getElementById('monthRides').textContent = `${monthBookings.length} rides`;
            document.getElementById('driverEarnings').textContent = `₹${Math.round(driverShare)}`;

            // Earnings table
            const earningsTable = document.getElementById('earningsTableBody');
            if (completedBookings.length === 0) {
                earningsTable.innerHTML = '<tr><td colspan="5" class="empty-state"><i class="fas fa-chart-line"></i><p>No earnings data</p></td></tr>';
            } else {
                const grouped = {};
                completedBookings.forEach(b => {
                    const date = new Date(b.createdAt).toLocaleDateString();
                    if (!grouped[date]) grouped[date] = [];
                    grouped[date].push(b);
                });

                earningsTable.innerHTML = Object.entries(grouped).map(([date, rides]) => {
                    const total = rides.reduce((sum, r) => sum + (r.totalFare || 0), 0);
                    const driverShare = Math.round(total * 0.7);
                    const platformShare = Math.round(total * 0.3);

                    return `
                        <tr>
                            <td>${date}</td>
                            <td>${rides.length}</td>
                            <td>₹${total}</td>
                            <td>₹${driverShare}</td>
                            <td>₹${platformShare}</td>
                        </tr>
                    `;
                }).join('');
            }
        }

        // ============================================
        // SETTINGS
        // ============================================

        function saveSettings() {
            const settings = {
                baseFare: parseInt(document.getElementById('baseFare').value),
                economyRate: parseInt(document.getElementById('economyRate').value),
                premiumRate: parseInt(document.getElementById('premiumRate').value),
                xlRate: parseInt(document.getElementById('xlRate').value),
                driverShare: parseInt(document.getElementById('driverShare').value),
                platformShare: parseInt(document.getElementById('platformShare').value),
                tax: parseInt(document.getElementById('tax').value),
                emailNotif: document.getElementById('emailNotif').checked,
                smsNotif: document.getElementById('smsNotif').checked,
                pushNotif: document.getElementById('pushNotif').checked
            };

            localStorage.setItem('appSettings', JSON.stringify(settings));
            showSuccess('✅ Settings saved successfully!');
        }

        function generateReport() {
            alert('📊 Report generated! Download feature coming soon.');
        }

        // ============================================
        // TAB SWITCHING
        // ============================================

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));

            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');

            const titles = {
                'dashboard': 'Dashboard',
                'bookings': 'Bookings Management',
                'customers': 'Customers',
                'drivers': 'Drivers',
                'earnings': 'Earnings & Revenue',
                'reports': 'Reports',
                'settings': 'Settings'
            };

            document.getElementById('topbarTitle').textContent = titles[tabName] || 'Dashboard';
        }

        // ============================================
        // MESSAGES
        // ============================================

        function showSuccess(message) {
            document.getElementById('successText').textContent = message;
            document.getElementById('successMessage').classList.add('show');
            setTimeout(() => document.getElementById('successMessage').classList.remove('show'), 5000);
        }

        function showError(message) {
            document.getElementById('errorText').textContent = message;
            document.getElementById('errorMessage').classList.add('show');
            setTimeout(() => document.getElementById('errorMessage').classList.remove('show'), 5000);
        }

        // ============================================
        // LOGOUT
        // ============================================

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('currentAdmin');
                localStorage.removeItem('userRole');
                window.location.href = './login.html';
            }
        }

        // Close modals on background click
        window.onclick = (e) => {
            const customerModal = document.getElementById('addCustomerModal');
            const driverModal = document.getElementById('addDriverModal');
            if (e.target === customerModal) closeAddCustomerModal();
            if (e.target === driverModal) closeAddDriverModal();
        }

        console.log('🚀 Admin Dashboard loaded');
    </script>
</body>
</html>
